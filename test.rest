############################################
# Pastebin Lite – REST Tests
# Requires VS Code REST Client extension
############################################

@baseUrl = https://pastebin-lite-mrunmayee.vercel.app
# For local testing, switch to:
# @baseUrl = http://localhost:3000


############################################
# Health Check
############################################

### Health check (should return { "ok": true })
GET {{baseUrl}}/api/healthz
Accept: application/json


############################################
# Create Paste – Basic
############################################

### Create paste (no TTL, no view limit)
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "Hello from Pastebin Lite!"
}


############################################
# Create Paste – With TTL
############################################

### Create paste with TTL (60 seconds)
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "This paste expires in 60 seconds",
  "ttl_seconds": 60
}


############################################
# Create Paste – With Max Views
############################################

### Create paste with max_views = 2
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "This paste can only be viewed twice",
  "max_views": 2
}


############################################
# Create Paste – TTL + Max Views
############################################

### Create paste with both TTL and max views
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "TTL + View limit example",
  "ttl_seconds": 120,
  "max_views": 1
}


############################################
# Fetch Paste (API)
# Replace {{pasteId}} with returned id
############################################

@pasteId = ScLzES4O

### Fetch paste via API (counts as a view)
GET {{baseUrl}}/api/pastes/{{pasteId}}
Accept: application/json


############################################
# Fetch Paste – Deterministic Test Mode
############################################

### Fetch paste using test time header (TEST_MODE=1 required)
GET {{baseUrl}}/api/pastes/{{pasteId}}
Accept: application/json
x-test-now-ms: 1893456000000


############################################
# View Paste (HTML)
############################################

### View paste in browser (HTML, does NOT count as view)
GET {{baseUrl}}/p/{{pasteId}}


############################################
# Error Handling – Invalid Inputs
############################################

### Create paste with empty content (should return 4xx)
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": ""
}


### Create paste with invalid TTL (should return 4xx)
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "Invalid TTL",
  "ttl_seconds": 0
}


### Create paste with invalid max_views (should return 4xx)
POST {{baseUrl}}/api/pastes
Content-Type: application/json

{
  "content": "Invalid views",
  "max_views": -1
}


############################################
# Error Handling – Non-existent Paste
############################################

### Fetch non-existent paste (should return 404)
GET {{baseUrl}}/api/pastes/doesNotExist
Accept: application/json


### View non-existent paste (HTML 404)
GET {{baseUrl}}/p/doesNotExist
